MySQL 数据库常见的优化手段分为三个层面，每个大的方向中又包含多个小的优化点：

-   SQL和索引优化
-   数据库结构优化
-   系统硬件优化

## SQL和索引优化

### 使用正确的索引
1.  尽可能使用主键查询，而非其他索引查询。因为主键查询不会触发回表查询，因此节省了一部分时间，变相的提高了查询的性能。
2.  在 MySQL 5.0 之前的版本要尽量避免使用 `or` 查询，可以使用 `union` 或者子查询来替代。因为早期的 MySQL 版本使用 `or` 查询可能会导致索引失效，在 MySQL 5.0 之后的版本中引入了索引合并，简单来说就是把多条件查询，比如 `or` 或 `and` 查询的结果集进行合并交集或并集的功能，因此就不会导致索引失效的问题了。
3.  避免在 `where` 查询条件中使用 `!=` 或者 `<>` 操作符。因为这些操作符会导致查询引擎放弃索引而进行全表扫描。
4.  适当使用前缀索引。MySQL 支持前缀索引，也就是说我们可以定义字符串的一部分来作为索引。我们知道索引越长占用的磁盘空间就越大，那么在相同数据页中能放下的索引值也就越少，这就意味着搜索索引需要的查询时间也就越长，进而查询的效率就会降低，所以我们可以适当的选择使用前缀索引，以减少空间的占用和提高查询效率。比如，邮箱的后缀都是固定的 `@xxx.com，那么类似这种后面几位为固定值的字段就非常适合定义为前缀索引。

### 查询具体的字段而非全部字段

要尽量避免使用 `select*`，而是查询需要的字段，这样可以提升速度，以及减少网络传输的带宽压力。

### 优化子查询

尽量使用 `Join` 语句来替代子查询。

因为子查询是嵌套查询，而嵌套查询会新创建一张临时表，而临时表的创建与销毁会占用一定的系统资源以及花费一定的时间，但 `Join` 语句并不会创建临时表，因此性能会更高。

### 注意查询结果集

尽量使用小表驱动大表的方式进行查询，也就是如果 B 表的数据小于 A 表的数据，那执行的顺序就是先查 B 表再查 A 表，具体查询语句如下：

```text
select name from A where id in (select id from B);
```

### 不要在列上进行运算操作

不要在列字段上进行算术运算或其他表达式运算，否则可能会导致查询引擎无法正确使用索引，从而影响了查询的效率。

### 适当增加冗余字段

增加冗余字段可以减少大量的连表查询。因为多张表的连表查询性能很低，所有可以适当的增加冗余字段，以减少多张表的关联查询，这是以空间换时间的优化策略。



## 数据库结构优化

### 最小数据长度

一般说来数据库的表越小，那么它的查询速度就越快，因此为了提高表的效率，应该将表的字段设置的尽可能小，比如身份证号，可以设置为 `char(18)` 就不要设置为 `varchar(18)`。

### 使用最简单数据类型

能使用 `int` 类型就不要使用 `varchar` 类型，因为 `int` 类型比 `varchar` 类型的查询效率更高。

### 尽量少定义 `text` 类型

`text` 类型的查询效率很低，如果必须要使用 `text` 定义字段，可以把此字段分离成子表，需要查询此字段时使用联合查询，这样可以提高主表的查询效率。

### 适当分表、分库策略

分表和分库方案也是我们经常说的垂直分隔（分表）和水平分隔（分库）。

分表是指当一张表中的字段更多时，可以尝试将一张大表拆分为多张子表，把使用比较高频的主信息放入主表中，其他的放入子表，这样我们大部分查询只需要查询字段更少的主表就可以完成了，从而有效的提高了查询的效率。

分库是指将一个数据库分为多个数据库。比如我们把一个数据库拆分为了多个数据库，一个主数据库用于写入和修改数据，其他的用于同步主数据并提供给客户端查询，这样就把一个库的读和写的压力，分摊给了多个库，从而提高了数据库整体的运行效率。



## 硬件优化

MySQL 对硬件的要求主要体现在三个方面：磁盘、网络和内存。

### 磁盘

磁盘应该尽量使用有高性能读写能力的磁盘，比如固态硬盘，这样就可以减少 I/O 运行的时间，从而提高了 MySQL 整体的运行效率。

磁盘也可以尽量使用多个小磁盘而不是一个大磁盘，因为磁盘的转速是固定的，有多个小磁盘就相当于拥有多个并行运行的磁盘一样。

### 网络

保证网络带宽的通畅（低延迟）以及够大的网络带宽是 MySQL 正常运行的基本条件，如果条件允许的话也可以设置多个网卡，以提高网络高峰期 MySQL 服务器的运行效率。

### 内存

MySQL 服务器的内存越大，那么存储和缓存的信息也就越多，而内存的性能是非常高的，从而提高了整个 MySQL 的运行效率。